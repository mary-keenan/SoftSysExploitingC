/* this is based on project 1 in the City College Exploit Development 
course (https://samsclass.info/127/proj/p1-lbci.htm)
*/

#include <string.h>
#include <stdio.h>

main(){
        char name[200];
        printf("What is your name?\n");
        scanf("%s", name);
        bo(name, "uname -a");
}

int bo(char *name, char *cmd){
        char c[40];
        char buffer[40];
        printf("Name buffer address:    %x\n", buffer);
        printf("Command buffer address: %x\n", c);
        strcpy(c, cmd);
        strcpy(buffer, name);
        printf("Goodbye, %s!\n", buffer);
        printf("Executing command: %s\n", c);
        fflush(stdout);
        system(c);
}

/* 
if I run this program and enter 50 A's 
(AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA), the program
will crash. 

If I enter 10 A's, 10 B's, 10 C's, 10 D's, and 10 E's
(AAAAAAAAABBBBBBBBBBCCCCCCCCCCDDDDDDDDDDEEEEEEEEEE), the program crashes
with the error "Executing command: E", which means that the buffer size
is 49 characters (and everything after 49 characters rolls over).

If I enter 49 characters then add "ls" to the end
(AAAAAAAAABBBBBBBBBBCCCCCCCCCCDDDDDDDDDDEEEEEEEEEls), the program lists
all of the files in the working directory.
*/